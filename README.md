# AI Avatars Stream — MVP

Проект: автономные AI‑агенты с аватарами ведут научную дискуссию в прямом эфире (OBS → RTMP). Цель — быстрый, стабильный MVP «за 1–2 дня».

## Что уже сделано
- Чекпоинт 1 готов (OBS‑only, ручное аудио): базовая сцена, `AUDIO_PLAYER`, ручное проигрывание mp3 в OBS подтверждено.
- Зафиксирована архитектура MVP в `docs/arch.md`.
- Сформирован подробный план работ по чекпоинтам в `docs/plan.md`.
- Реализован OBS WebSocket клиент `src/obs_client.py` + `self_check()` (сцены, медиа‑файл, перезапуск).
- Реализован оркестратор `src/orchestrator.py`: очередь, prefetch, переключение сцен, воспроизведение mp3, запись транскрипта.
- Ожидание длительности трека синхронизировано через `ffprobe` (устойчиво к глюкам статуса OBS).
- Интегрированы LLM/TTS/summary/topic: `src/llm.py`, `src/tts.py`, `src/summarize.py`, `src/topic.py`, `src/retry.py`.
- Добавлены правила «стрим‑формата»: вступление, смена уровня, steelman, финальные раунды, закрытие, ограничение длины реплик.

## Текущий статус
- Чекпоинт 1: готов.
- Чекпоинт 2: готов (OBS WebSocket контроль сцен/медиа подтверждён).
- Чекпоинт 3: готов (очередь + prefetch + сцены + транскрипт).
- Чекпоинт 4: базовая интеграция готова; остаются таймауты/расширенное логирование и «вау‑эффекты».

## Содержимое репозитория
- `docs/arch.md` — архитектура MVP и принятые решения.
- `docs/plan.md` — план работ по чекпоинтам.
- `docs/tz.docx` — исходное ТЗ.
- `src/obs_client.py` — клиент OBS WebSocket и `self_check()`.
- `src/orchestrator.py` — оркестратор для preloaded mp3.
- `src/llm.py`, `src/tts.py`, `src/summarize.py`, `src/topic.py` — модули CP4.
- `src/retry.py` — общий retry/backoff.

## Дефолты MVP (зафиксировано)
- OBS проигрывает аудио через **Media Source**.
- Один аудио‑источник: `AUDIO_PLAYER`.
- `queue_floor=2`.
- Hot‑reload темы каждые 2–5 минут (`TOPIC`/`topic.txt`).
- Контекст: последние 10–12 реплик + краткий summary.
- Длина реплики: по умолчанию 1–2 предложения (`MAX_SENTENCES=2`).
- Длина эфира: 25 ходов с финальными раундами и закрытием (`MAX_TURNS=25`).

## Следующие шаги
См. `docs/plan.md` — актуальные задачи и «вау‑эффекты» для сдачи.
